#!/bin/sh
if [ "$SUBSYSTEM" == "pcmcia_socket" ];then
	logger "Setting up PCMCIA socket resource database"
	if [ "$ACTION" == "add" ];then
		/usr/sbin/pcmcia-socket-startup
	fi
fi
if [ "$SUBSYSTEM" == "usb" ];then
        if [ "$ACTION" == "add" ];then
                if [ "$DEVTYPE" == "usb_device" ];then
                        if [ "$PRODUCT" == "12d1/1003/0" ];then
				if [ ! -f /tmp/.huawei ];then
                        		logger "USB device added with: $PRODUCT"
					usbmods=$(lsmod|grep ^usbserial|awk '{ print $4 }'|sed -e 's/,/ /g')
					for i in $usbmods;do rmmod $i;done
					rmmod usbserial
					lsmod >> /tmp/debug
                                	test -x /sbin/huawei && /sbin/huawei >> /tmp/debug
					insmod /lib/modules/$(uname -r)/usbserial.ko product=0x1003 vendor=0x12d1
					for i in $usbmods;do insmod /lib/modules/$(uname -r)/$i.ko; done
					
					touch /tmp/.huawei
				fi
                        fi
                fi
        fi
fi
