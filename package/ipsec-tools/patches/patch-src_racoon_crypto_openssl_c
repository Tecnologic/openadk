--- ipsec-tools-0.8.0.orig/src/racoon/crypto_openssl.c	2010-10-20 15:40:02.000000000 +0200
+++ ipsec-tools-0.8.0/src/racoon/crypto_openssl.c	2011-03-31 13:22:18.821818767 +0200
@@ -63,8 +63,12 @@
 #ifdef HAVE_OPENSSL_ENGINE_H
 #include <openssl/engine.h>
 #endif
+#ifndef OPENSSL_NO_BF
 #include <openssl/blowfish.h>
+#endif
+#ifndef OPENSSL_NO_CAST
 #include <openssl/cast.h>
+#endif
 #include <openssl/err.h>
 #ifdef HAVE_OPENSSL_RC5_H
 #include <openssl/rc5.h>
@@ -1405,6 +1409,7 @@ eay_idea_keylen(len)
 }
 #endif
 
+#ifndef OPENSSL_NO_BF
 /*
  * BLOWFISH-CBC
  */
@@ -1439,6 +1444,7 @@ eay_bf_keylen(len)
 		return -1;
 	return len;
 }
+#endif
 
 #ifdef HAVE_OPENSSL_RC5_H
 /*
@@ -1550,6 +1556,7 @@ eay_3des_keylen(len)
 	return 192;
 }
 
+#ifndef OPENSSL_NO_CAST
 /*
  * CAST-CBC
  */
@@ -1584,6 +1591,7 @@ eay_cast_keylen(len)
 		return -1;
 	return len;
 }
+#endif
 
 /*
  * AES(RIJNDAEL)-CBC
