$Id: update-patches 24 2008-08-31 14:56:13Z wbx $
--- ipsec-tools-0.7.2.orig/src/racoon/crypto_openssl.c	2009-04-20 15:33:30.000000000 +0200
+++ ipsec-tools-0.7.2/src/racoon/crypto_openssl.c	2009-05-29 15:31:04.728378359 +0200
@@ -63,8 +63,12 @@
 #ifdef HAVE_OPENSSL_ENGINE_H
 #include <openssl/engine.h>
 #endif
+#ifndef OPENSSL_NO_BF
 #include <openssl/blowfish.h>
+#endif
+#ifndef OPENSSL_NO_CAST
 #include <openssl/cast.h>
+#endif
 #include <openssl/err.h>
 #ifdef HAVE_OPENSSL_RC5_H
 #include <openssl/rc5.h>
@@ -1347,6 +1351,7 @@ eay_idea_keylen(len)
 }
 #endif
 
+#ifndef OPENSSL_NO_BF
 /*
  * BLOWFISH-CBC
  */
@@ -1381,6 +1386,7 @@ eay_bf_keylen(len)
 		return -1;
 	return len;
 }
+#endif
 
 #ifdef HAVE_OPENSSL_RC5_H
 /*
@@ -1492,6 +1498,7 @@ eay_3des_keylen(len)
 	return 192;
 }
 
+#ifndef OPENSSL_NO_CAST
 /*
  * CAST-CBC
  */
@@ -1526,6 +1533,7 @@ eay_cast_keylen(len)
 		return -1;
 	return len;
 }
+#endif
 
 /*
  * AES(RIJNDAEL)-CBC
