--- samba-3.5.3.orig/client/mount.cifs.c	2010-05-17 13:51:23.000000000 +0200
+++ samba-3.5.3/client/mount.cifs.c	2010-06-11 12:39:34.501613636 +0200
@@ -39,7 +39,6 @@
 #include <mntent.h>
 #include <fcntl.h>
 #include <limits.h>
-#include <fstab.h>
 #include "mount.h"
 
 #define MOUNT_CIFS_VERSION_MAJOR "1"
@@ -112,7 +111,7 @@
  * The legacy behavior is now disabled by default. To reenable it, set the
  * following #define to true.
  */
-#define CIFS_LEGACY_SETUID_CHECK 0
+#define CIFS_LEGACY_SETUID_CHECK 1
 
 /*
  * When an unprivileged user runs a setuid mount.cifs, we set certain mount
