--- valgrind-3.5.0.orig/configure	2009-08-19 15:44:07.000000000 +0200
+++ valgrind-3.5.0/configure	2010-04-03 09:55:06.363473068 +0200
@@ -4215,7 +4215,7 @@ echo "${ECHO_T}ok (${host_os})" >&6
         echo "$as_me:$LINENO: checking for the kernel version" >&5
 echo $ECHO_N "checking for the kernel version... $ECHO_C" >&6
 
-        kernel=`uname -r`
+        kernel=2.6.33
 
         case "${kernel}" in
              2.6.*)
@@ -4841,6 +4841,27 @@ if (eval "$ac_cpp conftest.$ac_ext") 2>&
 fi
 rm -f conftest*
 
+cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+#include <features.h>
+#ifdef __GNU_LIBRARY__
+ #if (__GLIBC__ == 2 && __GLIBC_MINOR__ == 11)
+  GLIBC_211
+ #endif
+#endif
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "GLIBC_211" >/dev/null 2>&1; then
+  libc="2.11"
+fi
+rm -f conftest*
+
 
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
@@ -5005,15 +5026,15 @@ cat >>conftest.$ac_ext <<_ACEOF
 
 #include <features.h>
 #ifdef __GNU_LIBRARY__
- #if (__GLIBC__ == 2 && __GLIBC_MINOR__ == 10)
-  GLIBC_210
+ #if (__GLIBC__ == 2 && __GLIBC_MINOR__ == 11)
+  GLIBC_211
  #endif
 #endif
 
 _ACEOF
 if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "GLIBC_210" >/dev/null 2>&1; then
-  GLIBC_VERSION="2.10"
+  $EGREP "GLIBC_211" >/dev/null 2>&1; then
+  GLIBC_VERSION="2.11"
 fi
 rm -f conftest*
 
@@ -5174,6 +5195,17 @@ _ACEOF
 	DEFAULT_SUPP="glibc-2.34567-NPTL-helgrind.supp ${DEFAULT_SUPP}"
 	DEFAULT_SUPP="glibc-2.X-drd.supp ${DEFAULT_SUPP}"
 	;;
+     2.11*)
+	echo "$as_me:$LINENO: result: 2.11 family" >&5
+echo "${ECHO_T}2.11 family" >&6
+
+cat >>confdefs.h <<\_ACEOF
+#define GLIBC_2_11 1
+_ACEOF
+
+	DEFAULT_SUPP="glibc-2.X.supp ${DEFAULT_SUPP}"
+	DEFAULT_SUPP="glibc-2.34567-NPTL-helgrind.supp ${DEFAULT_SUPP}"
+	;;
      aix5)
 	echo "$as_me:$LINENO: result: AIX 5.1 or 5.2 or 5.3" >&5
 echo "${ECHO_T}AIX 5.1 or 5.2 or 5.3" >&6
@@ -5198,7 +5230,7 @@ _ACEOF
      *)
 	echo "$as_me:$LINENO: result: unsupported version" >&5
 echo "${ECHO_T}unsupported version" >&6
-	{ { echo "$as_me:$LINENO: error: Valgrind requires glibc version 2.2 - 2.10" >&5
+	{ { echo "$as_me:$LINENO: error: Valgrind requires glibc version 2.2 - 2.11.1" >&5
 echo "$as_me: error: Valgrind requires glibc version 2.2 - 2.10" >&2;}
    { (exit 1); exit 1; }; }
 	{ { echo "$as_me:$LINENO: error: or AIX 5.1 or 5.2 or 5.3 GLIBC_VERSION" >&5
